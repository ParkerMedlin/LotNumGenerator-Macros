Sub increment()
'///Not assigned to anything///////////////////////////////////////////////////////////////////////////////////////////////
'///Inserts a new line and handles all the formula re-populating + time-stamping + incrementing lot no/////////////////////

'Macros off
    Call MacrosOff

'Copy everything on the first line and insert it below
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]+1"
    Range("H1").Select
    Selection.Copy
    Range("G1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("H1").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Sheets("Lot Number Generator").Select
    Range("A2:E2").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Rows("2:2").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove

'Copy the latest lot number from the lot generator sheet and paste it into the top row for the next lot
    Sheets("lotGenerator").Select
    Range("F1").Select
    Selection.Copy
    Sheets("Lot Number Generator").Select
    Range("C2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("A2:C2").Select
    Application.CutCopyMode = False
    Range("A2").Select

'Replace blend PN formula in A2
    ActiveCell.FormulaR1C1 = _
        "=INDEX(BLNDSHTS[ComponentItemCode from Sage],MATCH(R[0]C[1],BLNDSHTS[Description from Sage],0))"
    Range("B2").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=search!$A$1#"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With

'Format row 2
    Range("A2:E2").Select
    Selection.Font.Bold = False
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F2:U2").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

'Insert DateTime into the date column
    Range("E2").Select
    ActiveCell.FormulaR1C1 = "=NOW()"
    Range("E2").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

'Copy play button and qty and arrow icon to new row
    Range("G4:V4").Select
    Selection.Copy
    Range("G3").Select
    ActiveCell.PasteSpecial Paste:=xlPasteAll

'Clear out the date and other info from Line/Run Date/Day columns
    Range("Q3:S3").ClearContents
    
'Delete Conditional Formatting that has copied down to the next row from the MacrosOn/MacrosOff buttons
    Range("K2:X2").Select
    Selection.FormatConditions.Delete
    
'Issue sheet header
    Range("H1").Value = "IssueSht"

'Clear AA5
    Range("AA5").Select
    Selection.ClearContents
    Range("A3").Select
    
'apply borders
    Range("A3:G3").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = -0.249977111117893
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = -0.249977111117893
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = -0.249977111117893
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = -0.249977111117893
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = -0.249977111117893
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
'Macros on
    Call MacrosOn

'Save immediately
    ActiveWorkbook.Save

End Sub

Sub plusSign()
'///assigned to plus sign icon/////////////////////////////////////////////////////////////////////////////////////////////
'///Calls the incrementor and then the WhichLine userform//////////////////////////////////////////////////////////////////

Call increment
WhichLineDialog_LOTNUM.Show

End Sub


Sub CopyLast()
'///Assigned to up arrow on Lot Number Generator sheet/////////////////////////////////////////////////////////////////////
'///Horix and Drum lot numbers any% speedrun///////////////////////////////////////////////////////////////////////////////

Dim i As Integer
Dim loopCount As Integer
loopCount = Application.InputBox(Prompt:="How many copies?", Type:=1)

'For loop that will run as many times as it is told to in the inputbox

For i = 1 To loopCount
'Copy up the last blend desc
    Range("B3").Select
    Selection.Copy
    Range("B2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

'Copy up the last blend qty
    Range("D3").Select
    Selection.Copy
    Range("D2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
 
'Do the normal increment stuff
    Call increment

'Copy the line info
    If Range("Q4") = "Hx" Then
        Call horixFormat
    ElseIf Range("Q4") = "Dm" Then
        Call drumFormat
    ElseIf Range("Q4") = "Totes" Then
        Call totesFormat
    ElseIf Range("Q4") = "Pails" Then
        Call pailsFormat
    ElseIf Range("Q4") = "Prod" Then
        Call prodFormat
    End If
 
'Copy the date
    Range("R4:S4").Select
    Selection.Copy
    Range("R3:S3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Next i

End Sub




Private Sub drumFormat()
'///What happens when you put in a Dm blend////////////////////////////////////////////////////////////////////////

'put 'Dm' in the line cell
    Range("Q3").Value = "Dm"

'fill the row 3 cells yellow
    Range("A3:U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
  
End Sub

Private Sub horixFormat()
'///What happens when you put in a Hx blend////////////////////////////////////////////////////////////////////////

'put 'Hx' in the line cell
    Range("Q3").Value = "Hx"

'fill the row 3 cells green
    Range("A3:U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

End Sub

Private Sub pailsFormat()
'///What happens when you put in a pails blend/////////////////////////////////////////////////////////////////////

'put 'Pails' in the line cell
    Range("Q3").Value = "Pails"

'fill the row 3 cells yellow
    Range("A3:U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    
End Sub

Private Sub prodFormat()
    
'put 'Prod' in the line cell
    Range("Q3").Value = "Prod"
    Range("R3").Value = " - "
    Range("S3").Value = " - "
    
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
End Sub

Private Sub totesFormat()
'///What happens when you put in a totes blend////////////////////////////////////////////////////////////////////

'put 'Totes' in the line cell
    Range("Q3").Value = "Totes"

'fill the row 3 cells yellow
    Range("A3:U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    
End Sub


